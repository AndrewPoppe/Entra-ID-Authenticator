{
    "name": "Yale REDCap Authenticator",
    "namespace": "YaleREDCap\\YaleREDCapAuthenticator",
    "description": "This External Module enables SSO with Yale and YNHH.",
    "authors": [
        {
            "name": "Andrew Poppe",
            "email": "andrew.poppe@yale.edu",
            "institution": "Yale University"
        }
    ],
    "system-settings": [
        {
            "key": "general-section",
            "name": "<div class='yale-redcap-authenticator-descriptive p-2' style='background-color:#bd5319; color:#f9f9f9; border-radius: 0.375rem; text-align: center;'><strong>General Settings</strong></div>",
            "type": "descriptive"
        },
        {
            "key": "custom-login-page-enabled",
            "name": "<strong>Custom Login Page Enabled</strong>:<br>Check this box to enable the custom login page. If unchecked, the default REDCap login page will be used. You can still use the Yale SSO with the default REDCap login page",
            "type": "checkbox"
        },
        {
            "key": "create-new-users-on-login",
            "name": "<strong>Create New Users on Login</strong>:<br>Check this box to create new users in the REDCap user table when they log in with SSO for the first time. If unchecked, only users that already exist in the REDCap user table will be able to log in with SSO",
            "type": "checkbox"
        },
        {
            "key": "convert-table-user-to-yale-user",
            "name": "<strong>Convert Table User to Yale User</strong>:<br>Check this box to convert an existing table user to a Yale user upon first login via Entra ID",
            "type": "checkbox"
        },
        {
            "key": "entraid-yale-section",
            "name": "<div class='yale-redcap-authenticator-descriptive p-2' style='background-color:#00356b; color:#f9f9f9; border-radius: 0.375rem; text-align: center;'><strong>Yale Entra ID Details</strong><br>This section is used to configure the Entra ID connection for Yale University.<script>document.querySelectorAll('.yale-redcap-authenticator-descriptive').forEach(el => el.parentElement.style.width = '100%');</script></div>",
            "type": "descriptive"
        },
        {
            "key": "entraid-yale-ad-tenant-id",
            "name": "<strong>Yale Entra ID AD Tenant ID</strong>",
            "type": "text"
        },
        {
            "key": "entraid-yale-client-id",
            "name": "<strong>Yale Entra ID Client ID</strong>",
            "type": "text"
        },
        {
            "key": "entraid-yale-client-secret",
            "name": "<strong>Yale Entra ID Client Secret</strong>",
            "type": "password"
        },
        {
            "key": "entraid-yale-redirect-url",
            "name": "<strong>Yale Entra ID Redirect URL</strong>",
            "type": "text"
        },
        {
            "key": "entraid-yale-redirect-url-spa",
            "name": "<strong>Yale Entra ID Redirect URL for SPA</strong>",
            "type": "text"
        },
        {
            "key": "entraid-yale-logout-url",
            "name": "<strong>Yale Entra ID Logout URL</strong>",
            "type": "text"
        },
        {
            "key": "entraid-yale-allowed-groups",
            "name": "<strong>Yale Entra ID Allowed Groups</strong>:<br>Which Yale University groups should be allowed to log in? If left blank, all groups are allowed",
            "type": "text",
            "repeatable": true
        }
    ],
    "auth-ajax-actions": [
        "getUserType",
        "convertTableUserToYaleUser",
        "convertYaleUsertoTableUser"
    ],
    "no-auth-pages": [
        "YNHH_SAML_ACS",
        "yale_sso_login",
        "logout"
    ],
    "no-csrf-pages": [
        "YNHH_SAML_ACS"
    ],
    "enable-no-auth-logging": true,
    "enable-every-page-hooks-on-system-pages": true,
    "framework-version": 14,
    "compatibility": {
        "redcap-version-min": "13.7.0",
        "redcap-version-max": "",
        "php-version-min": "7.4.00",
        "php-version-max": "8.3.99"
    }
}